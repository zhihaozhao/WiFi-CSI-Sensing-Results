2025-08-20 23:21:03,481 [INFO] Starting training with args: {'model': 'cnn', 'difficulty': 'hard', 'seed': 4, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 60, 'batch': 256, 'n_samples': 3000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints/', 'logit_l2': 0.1, 'sc_corr_rho': 0.8, 'env_burst_rate': 0.2, 'gain_drift_std': 1.0, 'class_overlap': 0.98, 'temp_mode': 'logspace', 'temp_min': 0.2, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.25, 'cache_dir': 'cache/synth_data_d5scarce', 'amp': True, 'save_ckpt': 'final', 'num_workers_override': 2, 'prefetch_factor': 2, 'val_every': 3, 'out_json': '../WiFi-CSI-Sensing-Results/results_gpu/d5_2\\paperA_cnn_hard_s4.json', 'log_dir': ''}
2025-08-20 23:21:03,483 [INFO] Logs saved to: E:\WiFi-CSI-Project\WiFi-CSI-Sensing-Results\results_gpu\d5_2\logs\paperA_cnn_hard_s4.log
2025-08-20 23:21:03,527 [INFO] Using device: cuda
2025-08-20 23:21:26,044 [INFO] Dataset: Train=2100, Val=450, Test=450
2025-08-20 23:21:26,045 [INFO] DataLoader: num_workers=2, pin_memory=True
2025-08-20 23:21:26,191 [INFO] Model: cnn with 644216 params
2025-08-20 23:21:35,558 [INFO] Epoch 3/60 - Val Loss: 0.9829
2025-08-20 23:21:36,622 [INFO] Epoch 5/60 - Train Loss: 1.2178, Val Loss: nan, Val macro_f1: 0.6470, Avg Reg Loss: 0.410540
2025-08-20 23:21:37,188 [INFO] Epoch 6/60 - Val Loss: 0.7867
2025-08-20 23:21:38,730 [INFO] Epoch 9/60 - Val Loss: 0.7001
2025-08-20 23:21:39,221 [INFO] Epoch 10/60 - Train Loss: 1.0052, Val Loss: nan, Val macro_f1: 0.7789, Avg Reg Loss: 0.426764
2025-08-20 23:21:40,242 [INFO] Epoch 12/60 - Val Loss: 0.6350
2025-08-20 23:21:41,751 [INFO] Epoch 15/60 - Val Loss: 0.5684
2025-08-20 23:21:41,816 [INFO] Epoch 15/60 - Train Loss: 0.8578, Val Loss: 0.5684, Val macro_f1: 0.8283, Avg Reg Loss: 0.430538
2025-08-20 23:21:43,278 [INFO] Epoch 18/60 - Val Loss: 0.5738
2025-08-20 23:21:44,271 [INFO] Epoch 20/60 - Train Loss: 0.7181, Val Loss: nan, Val macro_f1: 0.8283, Avg Reg Loss: 0.429705
2025-08-20 23:21:44,816 [INFO] Epoch 21/60 - Val Loss: 0.4891
2025-08-20 23:21:46,441 [INFO] Epoch 24/60 - Val Loss: 0.4594
2025-08-20 23:21:46,987 [INFO] Epoch 25/60 - Train Loss: 0.6434, Val Loss: nan, Val macro_f1: 0.8544, Avg Reg Loss: 0.425998
2025-08-20 23:21:47,972 [INFO] Epoch 27/60 - Val Loss: 0.4593
2025-08-20 23:21:49,503 [INFO] Epoch 30/60 - Val Loss: 0.4455
2025-08-20 23:21:49,568 [INFO] Epoch 30/60 - Train Loss: 0.5939, Val Loss: 0.4455, Val macro_f1: 0.8801, Avg Reg Loss: 0.419854
2025-08-20 23:21:51,033 [INFO] Epoch 33/60 - Val Loss: 0.4353
2025-08-20 23:21:52,029 [INFO] Epoch 35/60 - Train Loss: 0.5598, Val Loss: nan, Val macro_f1: 0.8804, Avg Reg Loss: 0.414329
2025-08-20 23:21:52,558 [INFO] Epoch 36/60 - Val Loss: 0.4215
2025-08-20 23:21:54,109 [INFO] Epoch 39/60 - Val Loss: 0.4465
2025-08-20 23:21:54,665 [INFO] Epoch 40/60 - Train Loss: 0.5390, Val Loss: nan, Val macro_f1: 0.8894, Avg Reg Loss: 0.409551
2025-08-20 23:21:55,719 [INFO] Epoch 42/60 - Val Loss: 0.4135
2025-08-20 23:21:57,188 [INFO] Epoch 45/60 - Val Loss: 0.4382
2025-08-20 23:21:57,243 [INFO] Epoch 45/60 - Train Loss: 0.5296, Val Loss: 0.4382, Val macro_f1: 0.8861, Avg Reg Loss: 0.409255
2025-08-20 23:21:58,689 [INFO] Epoch 48/60 - Val Loss: 0.4121
2025-08-20 23:21:59,676 [INFO] Epoch 50/60 - Train Loss: 0.5206, Val Loss: nan, Val macro_f1: 0.8916, Avg Reg Loss: 0.404550
2025-08-20 23:22:00,206 [INFO] Epoch 51/60 - Val Loss: 0.4161
2025-08-20 23:22:01,739 [INFO] Epoch 54/60 - Val Loss: 0.4181
2025-08-20 23:22:02,251 [INFO] Epoch 55/60 - Train Loss: 0.5146, Val Loss: nan, Val macro_f1: 0.8975, Avg Reg Loss: 0.402539
2025-08-20 23:22:03,253 [INFO] Epoch 57/60 - Val Loss: 0.4245
2025-08-20 23:22:04,877 [INFO] Epoch 60/60 - Val Loss: 0.4143
2025-08-20 23:22:04,945 [INFO] Epoch 60/60 - Train Loss: 0.5103, Val Loss: 0.4143, Val macro_f1: 0.8942, Avg Reg Loss: 0.400732
2025-08-20 23:22:05,013 [INFO] Collected test logits and targets
2025-08-20 23:22:05,059 [INFO] Calibration: T=0.5305, Details={'temperature': 0.5304545164108276, 'best_nll': 0.2821497619152069, 'method': 'logspace'}
2025-08-20 23:22:05,183 [INFO] Saved full results to ../WiFi-CSI-Sensing-Results/results_gpu/d5_2\paperA_cnn_hard_s4.json
2025-08-20 23:22:05,189 [INFO] Final model saved to checkpoints/final_cnn_4_hard.pth
2025-08-20 23:22:05,190 [INFO] Updated registry: results\registry.csv
