2025-08-20 23:20:10,722 [INFO] Starting training with args: {'model': 'cnn', 'difficulty': 'hard', 'seed': 3, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 60, 'batch': 256, 'n_samples': 3000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints/', 'logit_l2': 0.1, 'sc_corr_rho': 0.8, 'env_burst_rate': 0.2, 'gain_drift_std': 1.0, 'class_overlap': 0.98, 'temp_mode': 'logspace', 'temp_min': 0.2, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.25, 'cache_dir': 'cache/synth_data_d5scarce', 'amp': True, 'save_ckpt': 'final', 'num_workers_override': 2, 'prefetch_factor': 2, 'val_every': 3, 'out_json': '../WiFi-CSI-Sensing-Results/results_gpu/d5_2\\paperA_cnn_hard_s3.json', 'log_dir': ''}
2025-08-20 23:20:10,723 [INFO] Logs saved to: E:\WiFi-CSI-Project\WiFi-CSI-Sensing-Results\results_gpu\d5_2\logs\paperA_cnn_hard_s3.log
2025-08-20 23:20:10,760 [INFO] Using device: cuda
2025-08-20 23:20:10,787 [INFO] Dataset: Train=2100, Val=450, Test=450
2025-08-20 23:20:10,788 [INFO] DataLoader: num_workers=2, pin_memory=True
2025-08-20 23:20:10,961 [INFO] Model: cnn with 644216 params
2025-08-20 23:20:17,626 [INFO] Epoch 3/60 - Val Loss: 1.3479
2025-08-20 23:20:19,428 [INFO] Epoch 5/60 - Train Loss: 1.2750, Val Loss: nan, Val macro_f1: 0.5350, Avg Reg Loss: 0.390163
2025-08-20 23:20:20,404 [INFO] Epoch 6/60 - Val Loss: 0.7447
2025-08-20 23:20:23,168 [INFO] Epoch 9/60 - Val Loss: 0.6911
2025-08-20 23:20:24,179 [INFO] Epoch 10/60 - Train Loss: 1.0524, Val Loss: nan, Val macro_f1: 0.7731, Avg Reg Loss: 0.462481
2025-08-20 23:20:26,020 [INFO] Epoch 12/60 - Val Loss: 0.6632
2025-08-20 23:20:28,813 [INFO] Epoch 15/60 - Val Loss: 0.6137
2025-08-20 23:20:28,918 [INFO] Epoch 15/60 - Train Loss: 0.9795, Val Loss: 0.6137, Val macro_f1: 0.8182, Avg Reg Loss: 0.442048
2025-08-20 23:20:31,159 [INFO] Epoch 18/60 - Val Loss: 0.6015
2025-08-20 23:20:32,309 [INFO] Epoch 20/60 - Train Loss: 0.9151, Val Loss: nan, Val macro_f1: 0.8288, Avg Reg Loss: 0.442090
2025-08-20 23:20:32,922 [INFO] Epoch 21/60 - Val Loss: 0.5856
2025-08-20 23:20:35,383 [INFO] Epoch 24/60 - Val Loss: 0.5532
2025-08-20 23:20:36,108 [INFO] Epoch 25/60 - Train Loss: 0.8238, Val Loss: nan, Val macro_f1: 0.8352, Avg Reg Loss: 0.438751
2025-08-20 23:20:37,957 [INFO] Epoch 27/60 - Val Loss: 0.5123
2025-08-20 23:20:40,537 [INFO] Epoch 30/60 - Val Loss: 0.4947
2025-08-20 23:20:40,637 [INFO] Epoch 30/60 - Train Loss: 0.7492, Val Loss: 0.4947, Val macro_f1: 0.8400, Avg Reg Loss: 0.448898
2025-08-20 23:20:42,834 [INFO] Epoch 33/60 - Val Loss: 0.4632
2025-08-20 23:20:44,459 [INFO] Epoch 35/60 - Train Loss: 0.6999, Val Loss: nan, Val macro_f1: 0.8713, Avg Reg Loss: 0.442055
2025-08-20 23:20:45,436 [INFO] Epoch 36/60 - Val Loss: 0.4315
2025-08-20 23:20:48,179 [INFO] Epoch 39/60 - Val Loss: 0.4146
2025-08-20 23:20:49,173 [INFO] Epoch 40/60 - Train Loss: 0.6482, Val Loss: nan, Val macro_f1: 0.9100, Avg Reg Loss: 0.443864
2025-08-20 23:20:51,045 [INFO] Epoch 42/60 - Val Loss: 0.3956
2025-08-20 23:20:53,842 [INFO] Epoch 45/60 - Val Loss: 0.4106
2025-08-20 23:20:53,947 [INFO] Epoch 45/60 - Train Loss: 0.6114, Val Loss: 0.4106, Val macro_f1: 0.9088, Avg Reg Loss: 0.438228
2025-08-20 23:20:56,469 [INFO] Epoch 48/60 - Val Loss: 0.4154
2025-08-20 23:20:57,607 [INFO] Epoch 50/60 - Train Loss: 0.5948, Val Loss: nan, Val macro_f1: 0.9270, Avg Reg Loss: 0.437555
2025-08-20 23:20:58,219 [INFO] Epoch 51/60 - Val Loss: 0.3829
2025-08-20 23:20:58,909 [INFO] Early stopping at epoch 52
2025-08-20 23:20:59,011 [INFO] Collected test logits and targets
2025-08-20 23:20:59,058 [INFO] Calibration: T=0.5661, Details={'temperature': 0.5660951137542725, 'best_nll': 0.28628018498420715, 'method': 'logspace'}
2025-08-20 23:20:59,201 [INFO] Saved full results to ../WiFi-CSI-Sensing-Results/results_gpu/d5_2\paperA_cnn_hard_s3.json
2025-08-20 23:20:59,209 [INFO] Final model saved to checkpoints/final_cnn_3_hard.pth
2025-08-20 23:20:59,210 [INFO] Updated registry: results\registry.csv
