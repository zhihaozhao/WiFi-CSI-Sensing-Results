2025-08-20 23:51:44,776 [INFO] Starting training with args: {'model': 'bilstm', 'difficulty': 'hard', 'seed': 4, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 60, 'batch': 256, 'n_samples': 3000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints/', 'logit_l2': 0.1, 'sc_corr_rho': 0.8, 'env_burst_rate': 0.2, 'gain_drift_std': 1.0, 'class_overlap': 0.98, 'temp_mode': 'logspace', 'temp_min': 0.2, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.25, 'cache_dir': 'cache/synth_data_d5scarce', 'amp': True, 'save_ckpt': 'final', 'num_workers_override': 2, 'prefetch_factor': 2, 'val_every': 3, 'out_json': '../WiFi-CSI-Sensing-Results/results_gpu/d5_2\\paperA_bilstm_hard_s4.json', 'log_dir': ''}
2025-08-20 23:51:44,780 [INFO] Logs saved to: E:\WiFi-CSI-Project\WiFi-CSI-Sensing-Results\results_gpu\d5_2\logs\paperA_bilstm_hard_s4.log
2025-08-20 23:51:44,812 [INFO] Using device: cuda
2025-08-20 23:51:44,840 [INFO] Dataset: Train=2100, Val=450, Test=450
2025-08-20 23:51:44,840 [INFO] DataLoader: num_workers=2, pin_memory=True
2025-08-20 23:51:45,123 [INFO] Model: bilstm with 583688 params
2025-08-20 23:51:54,033 [INFO] Epoch 3/60 - Val Loss: 1.5853
2025-08-20 23:51:57,813 [INFO] Epoch 5/60 - Train Loss: 1.6740, Val Loss: nan, Val macro_f1: 0.2334, Avg Reg Loss: 0.257572
2025-08-20 23:51:59,649 [INFO] Epoch 6/60 - Val Loss: 1.2299
2025-08-20 23:52:02,582 [INFO] Epoch 9/60 - Val Loss: 1.1216
2025-08-20 23:52:04,688 [INFO] Epoch 10/60 - Train Loss: 1.4137, Val Loss: nan, Val macro_f1: 0.5624, Avg Reg Loss: 0.320963
2025-08-20 23:52:08,377 [INFO] Epoch 12/60 - Val Loss: 1.1729
2025-08-20 23:52:11,190 [INFO] Epoch 15/60 - Val Loss: 1.0194
2025-08-20 23:52:11,252 [INFO] Epoch 15/60 - Train Loss: 1.3858, Val Loss: 1.0194, Val macro_f1: 0.5643, Avg Reg Loss: 0.330262
2025-08-20 23:52:15,426 [INFO] Epoch 18/60 - Val Loss: 1.0785
2025-08-20 23:52:17,668 [INFO] Epoch 20/60 - Train Loss: 1.3083, Val Loss: nan, Val macro_f1: 0.5643, Avg Reg Loss: 0.319350
2025-08-20 23:52:19,792 [INFO] Epoch 21/60 - Val Loss: 0.9721
2025-08-20 23:52:24,287 [INFO] Epoch 24/60 - Val Loss: 1.0511
2025-08-20 23:52:26,383 [INFO] Epoch 25/60 - Train Loss: 1.2886, Val Loss: nan, Val macro_f1: 0.5899, Avg Reg Loss: 0.315503
2025-08-20 23:52:28,994 [INFO] Epoch 27/60 - Val Loss: 0.9867
2025-08-20 23:52:33,024 [INFO] Epoch 30/60 - Val Loss: 1.0121
2025-08-20 23:52:33,082 [INFO] Epoch 30/60 - Train Loss: 1.2367, Val Loss: 1.0121, Val macro_f1: 0.6087, Avg Reg Loss: 0.329093
2025-08-20 23:52:37,222 [INFO] Epoch 33/60 - Val Loss: 0.9533
2025-08-20 23:52:39,446 [INFO] Epoch 35/60 - Train Loss: 1.1771, Val Loss: nan, Val macro_f1: 0.6087, Avg Reg Loss: 0.339651
2025-08-20 23:52:41,529 [INFO] Epoch 36/60 - Val Loss: 1.0957
2025-08-20 23:52:46,109 [INFO] Epoch 39/60 - Val Loss: 1.0061
2025-08-20 23:52:48,178 [INFO] Epoch 40/60 - Train Loss: 1.1833, Val Loss: nan, Val macro_f1: 0.6118, Avg Reg Loss: 0.332594
2025-08-20 23:52:51,034 [INFO] Epoch 42/60 - Val Loss: 1.1273
2025-08-20 23:52:56,795 [INFO] Epoch 45/60 - Val Loss: 0.9510
2025-08-20 23:52:57,279 [INFO] Epoch 45/60 - Train Loss: 1.1063, Val Loss: 0.9510, Val macro_f1: 0.6006, Avg Reg Loss: 0.336140
2025-08-20 23:52:59,696 [INFO] Epoch 48/60 - Val Loss: 1.0160
2025-08-20 23:53:01,350 [INFO] Early stopping at epoch 49
2025-08-20 23:53:01,834 [INFO] Collected test logits and targets
2025-08-20 23:53:01,877 [INFO] Calibration: T=0.7108, Details={'temperature': 0.7107774615287781, 'best_nll': 0.8542966842651367, 'method': 'logspace'}
2025-08-20 23:53:02,033 [INFO] Saved full results to ../WiFi-CSI-Sensing-Results/results_gpu/d5_2\paperA_bilstm_hard_s4.json
2025-08-20 23:53:02,039 [INFO] Final model saved to checkpoints/final_bilstm_4_hard.pth
2025-08-20 23:53:02,040 [INFO] Updated registry: results\registry.csv
