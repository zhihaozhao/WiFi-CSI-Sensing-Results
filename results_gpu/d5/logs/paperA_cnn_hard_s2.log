2025-08-20 23:19:13,172 [INFO] Starting training with args: {'model': 'cnn', 'difficulty': 'hard', 'seed': 2, 'F': 52, 'T': 128, 'num_classes': 8, 'epochs': 60, 'batch': 256, 'n_samples': 3000, 'early_metric': 'macro_f1', 'patience': 10, 'ckpt_dir': 'checkpoints/', 'logit_l2': 0.1, 'sc_corr_rho': 0.8, 'env_burst_rate': 0.2, 'gain_drift_std': 1.0, 'class_overlap': 0.98, 'temp_mode': 'logspace', 'temp_min': 0.2, 'temp_max': 5.0, 'temp_steps': 100, 'val_split': 0.5, 'fixed_temp': 1.0, 'label_noise_prob': 0.25, 'cache_dir': 'cache/synth_data_d5scarce', 'amp': True, 'save_ckpt': 'final', 'num_workers_override': 2, 'prefetch_factor': 2, 'val_every': 3, 'out_json': '../WiFi-CSI-Sensing-Results/results_gpu/d5_2\\paperA_cnn_hard_s2.json', 'log_dir': ''}
2025-08-20 23:19:13,174 [INFO] Logs saved to: E:\WiFi-CSI-Project\WiFi-CSI-Sensing-Results\results_gpu\d5_2\logs\paperA_cnn_hard_s2.log
2025-08-20 23:19:13,198 [INFO] Using device: cuda
2025-08-20 23:19:13,226 [INFO] Dataset: Train=2100, Val=450, Test=450
2025-08-20 23:19:13,227 [INFO] DataLoader: num_workers=2, pin_memory=True
2025-08-20 23:19:13,392 [INFO] Model: cnn with 644216 params
2025-08-20 23:19:20,309 [INFO] Epoch 3/60 - Val Loss: 1.1789
2025-08-20 23:19:21,938 [INFO] Epoch 5/60 - Train Loss: 1.3061, Val Loss: nan, Val macro_f1: 0.5290, Avg Reg Loss: 0.409728
2025-08-20 23:19:22,525 [INFO] Epoch 6/60 - Val Loss: 0.8051
2025-08-20 23:19:25,183 [INFO] Epoch 9/60 - Val Loss: 0.6976
2025-08-20 23:19:26,165 [INFO] Epoch 10/60 - Train Loss: 1.0444, Val Loss: nan, Val macro_f1: 0.7573, Avg Reg Loss: 0.439006
2025-08-20 23:19:27,991 [INFO] Epoch 12/60 - Val Loss: 0.6331
2025-08-20 23:19:30,832 [INFO] Epoch 15/60 - Val Loss: 0.5848
2025-08-20 23:19:30,937 [INFO] Epoch 15/60 - Train Loss: 0.9633, Val Loss: 0.5848, Val macro_f1: 0.8055, Avg Reg Loss: 0.454971
2025-08-20 23:19:33,612 [INFO] Epoch 18/60 - Val Loss: 0.6141
2025-08-20 23:19:35,490 [INFO] Epoch 20/60 - Train Loss: 0.8979, Val Loss: nan, Val macro_f1: 0.8055, Avg Reg Loss: 0.450932
2025-08-20 23:19:36,271 [INFO] Epoch 21/60 - Val Loss: 0.5621
2025-08-20 23:19:37,992 [INFO] Epoch 24/60 - Val Loss: 0.5456
2025-08-20 23:19:38,702 [INFO] Epoch 25/60 - Train Loss: 0.8114, Val Loss: nan, Val macro_f1: 0.8263, Avg Reg Loss: 0.441368
2025-08-20 23:19:40,396 [INFO] Epoch 27/60 - Val Loss: 0.5014
2025-08-20 23:19:42,775 [INFO] Epoch 30/60 - Val Loss: 0.4915
2025-08-20 23:19:42,884 [INFO] Epoch 30/60 - Train Loss: 0.7508, Val Loss: 0.4915, Val macro_f1: 0.8345, Avg Reg Loss: 0.437928
2025-08-20 23:19:45,417 [INFO] Epoch 33/60 - Val Loss: 0.4892
2025-08-20 23:19:47,034 [INFO] Epoch 35/60 - Train Loss: 0.7034, Val Loss: nan, Val macro_f1: 0.8375, Avg Reg Loss: 0.441098
2025-08-20 23:19:47,929 [INFO] Epoch 36/60 - Val Loss: 0.4925
2025-08-20 23:19:50,119 [INFO] Epoch 39/60 - Val Loss: 0.4935
2025-08-20 23:19:51,047 [INFO] Epoch 40/60 - Train Loss: 0.6678, Val Loss: nan, Val macro_f1: 0.8391, Avg Reg Loss: 0.439254
2025-08-20 23:19:52,848 [INFO] Epoch 42/60 - Val Loss: 0.5551
2025-08-20 23:19:55,680 [INFO] Epoch 45/60 - Val Loss: 0.5129
2025-08-20 23:19:55,785 [INFO] Epoch 45/60 - Train Loss: 0.6359, Val Loss: 0.5129, Val macro_f1: 0.8156, Avg Reg Loss: 0.440077
2025-08-20 23:19:58,466 [INFO] Epoch 48/60 - Val Loss: 0.5190
2025-08-20 23:20:00,292 [INFO] Epoch 50/60 - Train Loss: 0.6188, Val Loss: nan, Val macro_f1: 0.8396, Avg Reg Loss: 0.440942
2025-08-20 23:20:01,293 [INFO] Epoch 51/60 - Val Loss: 0.5321
2025-08-20 23:20:03,157 [INFO] Epoch 54/60 - Val Loss: 0.5212
2025-08-20 23:20:03,759 [INFO] Epoch 55/60 - Train Loss: 0.6025, Val Loss: nan, Val macro_f1: 0.8396, Avg Reg Loss: 0.432374
2025-08-20 23:20:05,271 [INFO] Epoch 57/60 - Val Loss: 0.5242
2025-08-20 23:20:06,134 [INFO] Early stopping at epoch 58
2025-08-20 23:20:06,216 [INFO] Collected test logits and targets
2025-08-20 23:20:06,258 [INFO] Calibration: T=0.7343, Details={'temperature': 0.7342674136161804, 'best_nll': 0.5547051429748535, 'method': 'logspace'}
2025-08-20 23:20:06,388 [INFO] Saved full results to ../WiFi-CSI-Sensing-Results/results_gpu/d5_2\paperA_cnn_hard_s2.json
2025-08-20 23:20:06,397 [INFO] Final model saved to checkpoints/final_cnn_2_hard.pth
2025-08-20 23:20:06,398 [INFO] Updated registry: results\registry.csv
